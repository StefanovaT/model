<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>CRM0601 Create Sales Orders (Single Execution) | ERP.net Domain Model </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="CRM0601 Create Sales Orders (Single Execution) | ERP.net Domain Model ">
      
      
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ErpNetDocs/model/blob/master/generations/CRM0601.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="crm0601-create-sales-orders-single-execution">CRM0601 Create Sales Orders (Single Execution)</h1>

<h2 id="general-information">General Information</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Module</th>
<th>Crm.Crm.Marketing</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Code</td>
<td>CRM0601</td>
</tr>
<tr>
<td style="text-align: left;">Parent Document</td>
<td>Marketing Activities</td>
</tr>
<tr>
<td style="text-align: left;">Sub-document</td>
<td>Sales Orders</td>
</tr>
<tr>
<td style="text-align: left;">Full Name</td>
<td>Create Sales Orders (Single Execution)</td>
</tr>
<tr>
<td style="text-align: left;">Deterministic</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/document-flow/deterministic-generations.html">YES</a></td>
</tr>
<tr>
<td style="text-align: left;">Status</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/document-flow/generation-procedures.html">NEW</a></td>
</tr>
<tr>
<td style="text-align: left;">Supports Transitional Documents</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/document-flow/transitional-documents.html">NO</a></td>
</tr>
<tr>
<td style="text-align: left;">Supports Single Execution</td>
<td>YES</td>
</tr>
<tr>
<td style="text-align: left;">Replaces</td>
<td>-</td>
</tr>
<tr>
<td style="text-align: left;">Orphan Rows</td>
<td>Ignore</td>
</tr>
<tr>
<td style="text-align: left;">Split Function</td>
<td>-</td>
</tr>
<tr>
<td style="text-align: left;">Version</td>
<td>Introduced: 2023</td>
</tr>
<tr>
<td style="text-align: left;">Date of Suspension</td>
<td>-</td>
</tr>
</tbody>
</table>
<h2 id="business-logic">Business Logic</h2>
<p>This generation is single execution only. If there are unfulfilled quantities from the Marketing Activity there will be no automatically generated documents for the differences. You can still create an execution for the differences by manually starting the generation.
<br><br>
To create a sales order, the customer has to be specified. <br>
The customer is extracted from the Target party, selected in the Marketing Activity (MarketingActivity.TargetParty). The customer has to be up-to-date,
with active customer definition for this party in the enterprise company of the sales order (SalesOrder.EnterpriseCompany) or for all enterprise companies:</p>
<pre><code>(Customer.Party = MarketingActivity.TargetParty &amp;&amp; 
(Customer.EnterpriseCompany == SalesOrder.EnterpriseCompany || Customer.EnterpriseCompany == null) &amp;&amp;
Customer.Active == true &amp;&amp; (Customer.FromDate &lt;= SalesOrder.DocumentDate || Customer.FromDate == null) &amp;&amp;
(Customer.ThruDate &gt;= SalesOrder.DocumentDate || Customer.ThruDate == null).
</code></pre>
<p>If no such customer is found, the generation procedure is stopped and an error is thrown. The error text is:</p>
<pre><code>No valid client is found for '{MarketingActivity.TargetParty.PartyName}' party. 
 In order to create a sales order, there must be an active customer for '{MarketingActivity.TargetParty.PartyName}' party,
 applicable to the current enterprise company.&quot;
</code></pre>
<p><strong>The fields in the Sales Order’s header are filled as follows:</strong></p>
<pre><code>SalesOrder.Customer = the determined Customer for the MarketingActivity.TargetParty

SalesOrder.DocumentDate = Today

SalesOrder.ShipToPartyContactMechanism = 
if (Count(PartyContactMechanisms, where Party == SalesOrder.Customer.Party &amp;&amp; IsDefault == true) == 1)
, then ShipToPartyContactMechanism = First(PartyContactMechanisms, where Party == SalesOrder.Customer.Party &amp;&amp; IsDefault == true)
, else SalesOrder.ShipToPartyContactMechanism = null
                                         
SalesOrder.DocumentCurrency = SalesOrder.EnterpriseCompany.BaseCurrency

SalesOrder.PaymentDueDate = DocumentDate + Customer.DefaultPaymentTermDays

SalesOrder.PaymentDueStartDate = DocumentDate + Customer.DefaultPaymentStartDays

SalesOrder.RequiredDeliveryDate = DocumentDate + Customer.DefaultDeliveryTermDays

SalesOrder.DistributionChannel = Customer.DefaultDistributionChannel

SalesOrder.PaymentAccount = Customer.DefaultPaymentAccount

SalesOrder.PaymentType = Customer.DefaultPaymentType

SalesOrder.PriceList = Customer.DefaultPriceList

SalesOrder.CreditLimitOverride = false

SalesOrder.Deal = null

SalesOrder.SalesPerson = null

SalesOrder.Dealer = null

SalesOrder.Store = null

SalesOrder.ShipToCustomer = null

SalesOrder.DealType = null

SalesOrder.CustomerPurchaseOrderDate = null

SalesOrder.CustomerPurchaseOrderNo = null

SalesOrder.PosLocation = null

SalesOrder.PosOperator = null

SalesOrder.PosTerminal = null

SalesOrder.FiscalSalesNumber = null

SalesOrder.FiscalPrinterPosDevice = null

SalesOrder.EndCustomerParty = null

SalesOrder.DeliveryTermsCode = null

SalesOrder.IntrastatTransactionNatureCode = null

SalesOrder.IntrastatTransportModeCode = null

SalesOrder.IntrastatTransportCountry = null

SalesOrder.ReturnForInvoice = null

SalesOrder.ReturnForSalesOrder = null

SalesOrder.FromDate = null

SalesOrder.ToDate = null

SalesOrder.Notes = null
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>The attributes which are not specified here are filled in as described in <strong><a href="../reference/standard-document-attributes.html">Standard Document Attributes</a></strong></p>
</div>
<h2 id="fulfillments">Fulfillments</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Name</th>
<th>MarketingActivityLineToSalesOrderLine</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Parent Entity</td>
<td>MarketingActivityLine</td>
</tr>
<tr>
<td style="text-align: left;">Child Entity</td>
<td>SalesOrderLine</td>
</tr>
<tr>
<td style="text-align: left;">Parent / Child Relationship</td>
<td>SalesOrderLine.ParentDocument = MarketingActivity; <br> SalesOrderLine.ParentLineNo = MarketingActivityLine.LineNo</td>
</tr>
</tbody>
</table>
<h2 id="metrics"><a href="../reference/metrics.html">Metrics</a></h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Fulfillment Name</th>
<th style="text-align: center;">Metric Name</th>
<th style="text-align: center;">Measurement Unit</th>
<th style="text-align: left;">Parent Value</th>
<th style="text-align: left;">Child Value</th>
<th style="text-align: left;">New Record</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">MarketingActivityLineToSalesOrderLine</td>
<td style="text-align: center;">MStandardQuantityBase</td>
<td style="text-align: center;">MarketingActivityLine.Product.BaseMeasurementCategory.BaseUnit</td>
<td style="text-align: left;">CONVERT(MarketingActivityLine.OrderQuantity, MarketingActivityLine.Product.BaseMeasurementCategory.BaseUnit)</td>
<td style="text-align: left;">SalesOrderLine.StandardQuantityBase</td>
<td style="text-align: left;">YES</td>
</tr>
</tbody>
</table>
<p><strong>The new Sales Order Line is created as follows:</strong></p>
<pre><code>SalesOrderLine.LineNo = MarketingActivity.LineNo 

SalesOrderLine.Product = MarketingActivity.Product

SalesOrderLine.ProductDescription = SalesOrderLine.Product.Name

SalesOrderLine.GuaranteePeriodDays = SalesOrderLine.Product.GuaranteePeriodDays

SalesOrderLine.ProductCode = null

SalesOrderLine.ProductPrice = loaded by the 'Determine product price'* method

SalesOrderLine.UnitPrice = loaded by the 'Calculate Unit Price' method
                      
SalesOrderLine.StandardUnitPrice = loaded by the 'Get Standard Unit Price' method

SalesOrderLine.RequestedQuantity = null

SalesOrderLine.Quantity = CONVERT( REMAINING(MarketingActivityLine.MStandardQuantityBase), MarketingActivityLine.OrderQuantityUnit)

SalesOrderLine.QuantityUnit = MarketingActivityLine.OrderQuantityUnit

SalesOrderLine.QuantityBase = REMAINING(MarketingActivityLine.MStandardQuantityBase)

SalesOrderLine.StandardQuantityBase = REMAINING(MarketingActivityLine.MStandardQuantityBase)

SalesOrderLine.Level1Discount = loaded by the 'Determine line discount'* method

SalesOrderLine.Level1DiscountPercent =
    if (SalesOrderLine.Level1Discount != null)
    , then SalesOrderLine.Level1DiscountPercent = SalesOrderLine.Level1Discount.DiscountPercent
    , else SalesOrderLine.Level1DiscountPercent = null

SalesOrderLine.Level2Discount = loaded by the 'Determine line discount'* method

SalesOrderLine.Level2DiscountPercent =
    if (SalesOrderLine.Level2Discount != null)
    , then SalesOrderLine.Level2DiscountPercent = SalesOrderLine.Level2Discount.DiscountPercent
    , else SalesOrderLine.Level2DiscountPercent = null

SalesOrderLine.Level3Discount = loaded by the 'Determine line discount'* method

SalesOrderLine.Level3DiscountPercent =
    if (SalesOrderLine.Level3Discount != null)
    , then SalesOrderLine.Level3DiscountPercent = SalesOrderLine.Level3Discount.DiscountPercent
    , else SalesOrderLine.Level3DiscountPercent = null

SalesOrderLine.LineStandardDiscountPercent = loaded by the 'Determine Line Standard Discount Percent' method
                                             
SalesOrderLine.LineCustomDiscountPercent = 0.00%

SalesOrderLine.LineAmount = loaded by the 'Determine line amount in sales orders'* method

SalesOrderLine.LineEndCustomerParty = null

SalesOrderLine.RequiredDeliveryDate = SalesOrder.RequiredDeliveryDate

PersistLot = false

SalesOrderLine.Notes = MarketingActivityLine.Notes

SalesOrderLine.ParentDocument = MarketingActivity

SalesOrderLine.ParentLineNo = MarketingActivityLine.LineNo

SalesOrderLine.Lot = null

SalesOrderLine.SerialNumber = null

SalesOrderLine.ProductVariant = null

SalesOrderLine.LineStore = null

SalesOrderLine.StoreBin = null

SalesOrderLine.LineDealType = null

SalesOrderLine.BonusProgram = null

SalesOrderLine.PromotionalPackage = null

SalesOrderLine.IntrastatApplyDate = null

SalesOrderLine.DeliveryTermsCode = null

SalesOrderLine.IntrastatTransactionNatureCode = null

SalesOrderLine.IntrastatTransportModeCode = null

SalesOrderLine.IntrastatTransportCountry = null

SalesOrderLine.ReturnForInvoiceLine = null

SalesOrderLine.ReturnForSalesOrderLine = null

SalesOrderLine.HistoricalDataJson = null

SalesOrderLine.HistoricalUnitCost = null

SalesOrderLine.LineFromDate = null

SalesOrderLine.LineToDate = null
</code></pre>
<br>
<p>*<a class="xref" href="https://erpnetdocs.github.io/tech/modules/crm/crm-common/crm-common-concepts/determine-product-price.html">Determine product price</a>
<br></p>
<p>*<a class="xref" href="https://erpnetdocs.github.io/tech/modules/crm/crm-common/crm-common-concepts/determine-line-discount.html">Determine line discount</a>
<br></p>
<p>*<a class="xref" href="https://erpnetdocs.github.io/tech/modules/crm/sales/sales-concepts/determining-algorithms/determine-line-amount-in-sales-orders.html">Determine line amount in sales orders</a></p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ErpNetDocs/model/blob/master/generations/CRM0601.md/#L1" class="edit-link">Suggest improvement to this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
