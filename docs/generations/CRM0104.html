<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>CRM0104 Create issue Store orders for products that aren&#39;t shipped | ERP.net Domain Model </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="CRM0104 Create issue Store orders for products that aren&#39;t shipped | ERP.net Domain Model ">
      
      
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ErpNetDocs/model/blob/master/generations/CRM0104.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="crm0104-create-issue-store-orders-for-products-that-arent-shipped">CRM0104 Create issue Store orders for products that aren't shipped</h1>

<h2 id="basic-information">Basic Information</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Module</th>
<th>Crm.Sales</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Code</td>
<td>CRM0104</td>
</tr>
<tr>
<td style="text-align: left;">Parent Document</td>
<td>Sales Order</td>
</tr>
<tr>
<td style="text-align: left;">Sub-document</td>
<td>Store Order</td>
</tr>
<tr>
<td style="text-align: left;">Full Name</td>
<td>Create issue Store orders for products that aren't shipped</td>
</tr>
<tr>
<td style="text-align: left;">Status</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/document-flow/generation-procedures.html">ACTIVE</a></td>
</tr>
<tr>
<td style="text-align: left;">Deterministic</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/document-flow/deterministic-generations.html">YES</a></td>
</tr>
<tr>
<td style="text-align: left;">Supports Transitional Documents</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/document-flow/transitional-documents.html">YES</a></td>
</tr>
<tr>
<td style="text-align: left;">Replaces</td>
<td>GenerateStoreOrdersForNonShipped</td>
</tr>
<tr>
<td style="text-align: left;">Orphan Rows</td>
<td>Ignore</td>
</tr>
<tr>
<td style="text-align: left;">Split Function</td>
<td>SalesOrderLine.StoreSalesOrderLine.RequiredDeliveryDate</td>
</tr>
<tr>
<td style="text-align: left;">Introduced In Version</td>
<td>2019.1</td>
</tr>
<tr>
<td style="text-align: left;">Date of Suspension</td>
<td>-</td>
</tr>
</tbody>
</table>
<h2 id="business-logic">Business Logic</h2>
<p>This Generation is used to create Store Orders for products from the current Sale Order that <strong>are not shipped</strong> (Product.ProductType.IsShipped = False) and <strong>are stocked</strong> (Product.ProductType.IsStocked = True).
For the rest of the products, the Store Orders are created from the Shipment Orders documents.
However, products that are not shipped does not participate in the Shipment Orders, for this reason, the current generation procedure needed in order for these products to be issued from the warehouse as well.</p>
<p>Different lines in the Sales Order may have different Stores or Required Delivery Dates, and for different values in these fields - different Store Orders should be created.
Therefore, at the beginning of the generation procedure, all combinations of Store and Required Delivery Date from the Sales Order Lines are determined (but only for the lines that are not used for returning goods according to the classification in topic <a class="xref" href="https://erpnetdocs.github.io/tech/modules/crm/sales/sales-concepts/sales-order-row-types.html">Sales Order Row Types</a> and whose products are not shipped and are stocked).</p>
<p>For each of these combinations of <strong>Store</strong> and <strong>Required Delivery Date</strong>, a separate Store Order is created. The Store Order’s header is created based on the Sales Order’s header as follows:</p>
<pre><code>StoreOrder.Store = Store

StoreOrder.MovementType = Issue

StoreOrder.DueDate = RequiredDeliveryDate

StoreOrder.PlannedReleaseDate = RequiredDeliveryDate

StoreOrder.PlannedCompletionDate = RequiredDeliveryDate

StoreOrder.IssuedByParty = Store.ResponsibleParty

StoreOrder.DocumentCurrency = SalesOrder.DocumentCurrency
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>the attributes which are not specified here are filled in as described in <a href="../reference/standard-document-attributes.html">Standard Document Attributes</a></p>
</div>
<h2 id="fulfillments">Fulfillments</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Name</th>
<th>SalesOrderLineToStoreOrderLine</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Parent Entity</td>
<td>SalesOrderLine</td>
</tr>
<tr>
<td style="text-align: left;">Child Entity</td>
<td>StoreOrderLine</td>
</tr>
<tr>
<td style="text-align: left;">Parent / Child Relationship</td>
<td>StoreOrderLine.ParentDocument = SalesOrder;StoreOrderLine.ParentLineNo = SalesOrderLine.LineNo</td>
</tr>
</tbody>
</table>
<h2 id="metrics"><a href="../reference/metrics.html">Metrics</a></h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Fulfillment Name</th>
<th style="text-align: center;">Metric Name</th>
<th style="text-align: center;">Measurement Unit</th>
<th style="text-align: left;">Parent Value</th>
<th style="text-align: left;">Child Value</th>
<th style="text-align: left;">New Record</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">SalesOrderLineToStoreOrderLine</td>
<td style="text-align: center;">MStandardQuantityBase</td>
<td style="text-align: center;">SalesOrderLine..Product.BaseMeasurementUnit</td>
<td style="text-align: left;">SalesOrderLine.StandardQuantityBase</td>
<td style="text-align: left;">StoreOrderLine.StandardQuantityBase</td>
<td style="text-align: left;">YES</td>
</tr>
<tr>
<td style="text-align: left;">SalesOrderLineToStoreOrderLine</td>
<td style="text-align: center;">MQuantity</td>
<td style="text-align: center;">SalesOrderLine.QuantityUnit</td>
<td style="text-align: left;">SalesOrderLine.Quantity</td>
<td style="text-align: left;">StoreOrderLine.Quantity</td>
<td style="text-align: left;">NO</td>
</tr>
<tr>
<td style="text-align: left;">SalesOrderLineToStoreOrderLine</td>
<td style="text-align: center;">MQuantityBase</td>
<td style="text-align: center;">SalesOrderLine.Product.BaseMeasurementUnit</td>
<td style="text-align: left;">SalesOrderLine.QuantityBase</td>
<td style="text-align: left;">StoreOrderLine.QuantityBase</td>
<td style="text-align: left;">NO</td>
</tr>
</tbody>
</table>
<p>The lines of the new document are created based on the data for the Fulfilled Part of quantities by Store Orders has already been created (for more information, see topic <a href="../reference/discrepancy-system.html">Discrepancy System</a> and <a href="../reference/metrics.html">Metrics</a>. The new StoreOrderLine is created as follows:</p>
<pre><code>StoreOrderLine.LineNo = SalesOrderLine.LineNo

StoreOrderLine.ParentLineId = SalesOrderLine.SalesOrderLineId

StoreOrderLine.Product = SalesOrderLine.Product

StoreOrderLine.StoreBin = SalesOrderLine.StoreBin

StoreOrderLine.SerialNumber = SalesOrderLine.SerialNumber

StoreOrderLine.Quantity = SalesOrderLine.REMAINING(MQuantity)

StoreOrderLine.QuantityUnit = SalesOrderLine.QuantityUnit

StoreOrderLine.QuantityBase = SalesOrderLine.REMAINING(MQuantityBase)

StoreOrderLine.StandardQuantityBase = SalesOrderLine.REMAINING(MStandardQuantityBase)

StoreOrderLine.Lot = SalesOrderLine.Lot

StoreOrderLine.GuaranteePeriodDays =

​            if SalesOrderLine.GuaranteePeriodDays.HasValue

​            then SalesOrderLine.GuaranteePeriodDays

​            else SalesOrderLine.Product.GuaranteePeriodDays

StoreOrderLine.SalesOrderLine = SalesOrderLine

StoreOrderLine.Notes = SalesOrderLine.Notes

StoreOrderLine.PersistLot = SalesOrderLine.PersistLot

StoreOrderLine.ProductVariant = SalesOrderLine.ProductVariant
StoreOrderLine.ParentDocument = SalesOrder

StoreOrderLine.ParentLineNo = SalesOrderLine.LineNo
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>WARNING: Any of the Shipment Orders created according to the description above is saved then and only when there is at least one line in it.</p>
</div>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ErpNetDocs/model/blob/master/generations/CRM0104.md/#L1" class="edit-link">Suggest improvement to this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
