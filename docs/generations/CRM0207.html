<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>CRM0207 Create Asset Оrder | ERP.net Domain Model </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="CRM0207 Create Asset Оrder | ERP.net Domain Model ">
      
      
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ErpNetDocs/model/blob/master/generations/CRM0207.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="crm0207-create-asset-оrder">CRM0207 Create Asset Оrder</h1>

<h2 id="basic-information">Basic Information</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Module</th>
<th>Crm.Invoices</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Code</td>
<td>CRM0207</td>
</tr>
<tr>
<td style="text-align: left;">Parent Document</td>
<td>Invoice</td>
</tr>
<tr>
<td style="text-align: left;">Sub-document</td>
<td>AssetOrder</td>
</tr>
<tr>
<td style="text-align: left;">Full Name</td>
<td>Create Asset Оrder</td>
</tr>
<tr>
<td style="text-align: left;">Status</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/document-flow/generation-procedures.html">ACTIVE</a></td>
</tr>
<tr>
<td style="text-align: left;">Deterministic</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/document-flow/deterministic-generations.html">YES</a></td>
</tr>
<tr>
<td style="text-align: left;">Supports Transitional Documents</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/document-flow/transitional-documents.html">NO</a></td>
</tr>
<tr>
<td style="text-align: left;">Replaces</td>
<td>GenerateAssetOrder</td>
</tr>
<tr>
<td style="text-align: left;">Orphan Rows</td>
<td>Forbid</td>
</tr>
<tr>
<td style="text-align: left;">Introduced In Version</td>
<td>2018.2</td>
</tr>
<tr>
<td style="text-align: left;">Date of Suspension</td>
<td>-</td>
</tr>
</tbody>
</table>
<h2 id="business-logic">Business Logic</h2>
<p>The generation procedure is activated when in the Invoice lines there are assets (assets are products with Product.ProductType.IsFixedAsset = true). For each such product, its corresponding fixed asset is found, and for all the found assets, an Asset Order is created in the Fixed Assets module for their retirement.</p>
<p>The AssetOrder header is created as follows:</p>
<pre><code>AssetOrder.Operation = Sale
</code></pre>
<p>The rest of the Document table attributes are filled in as described in <a href="../reference/standard-document-attributes.html">Standard Document Attributes</a>.</p>
<h2 id="fulfillments">Fulfillments</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Name</th>
<th>InvoiceLineToAssetOrderLine</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Parent Entity</td>
<td>InvoiceLine</td>
</tr>
<tr>
<td style="text-align: left;">Child Entity</td>
<td>AssetOrderLine</td>
</tr>
<tr>
<td style="text-align: left;">Parent / Child Relationship</td>
<td>AssetOrderLine.ParentDocument = Invoice;AssetOrderLine.ParentLineNo = InvoiceLine.LineNo</td>
</tr>
</tbody>
</table>
<h2 id="metrics"><a href="../reference/metrics.html">Metrics</a></h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Fulfillment Name</th>
<th style="text-align: center;">Metric Name</th>
<th style="text-align: center;">Measurement Unit</th>
<th style="text-align: left;">Parent Value</th>
<th style="text-align: left;">Child Value</th>
<th style="text-align: left;">New Record</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">InvoiceLineToAssetOrderLine</td>
<td style="text-align: center;">MQuantity</td>
<td style="text-align: center;">InvoiceLine.QuantityUnit</td>
<td style="text-align: left;">InvoiceLine.Quantity</td>
<td style="text-align: left;">AssetOrderLine.Quantity</td>
<td style="text-align: left;">YES</td>
</tr>
<tr>
<td style="text-align: left;">InvoiceLineToAssetOrderLine</td>
<td style="text-align: center;">MLineAmount</td>
<td style="text-align: center;">Invoice.DocumentCurrency</td>
<td style="text-align: left;">InvoiceLine.AssetValue</td>
<td style="text-align: left;">AssetOrderLine.AssetValue</td>
<td style="text-align: left;">YES</td>
</tr>
</tbody>
</table>
<p>The generation includes only Invoice Lines which product has value and which is a fixed asset and which quantity is not 0. For each of those lines, its corresponding fixed asset is found (<strong>Asset</strong>) and its sale value is defined <strong>(AssetValue)</strong>. The <strong>Asset</strong> is defined by an asset with the same code as the product (Asset.Code == InvoiceLine.Product.PartNumber).
If there are products for which no asset is found - the generation breaks and throws an error:</p>
<pre><code>&gt; Cannot find a record with Asset Code '{Product.PartNumber}' in the Assets table.
</code></pre>
<p>The <strong>AssetValue</strong> is defined as follows: the LineAmount of the InvoiceLine is summed up with the amounts of all additional amounts where AddToLine == true.</p>
<p>If the Quantity in the row is -1, the generation procedure breaks and throws an error:</p>
<pre><code>&gt; Line {LineNo} of {DocumentText} has invalid quantity of {Quantity}. The generated document is Asset Order for sale and the quantity cannot be negative.
</code></pre>
<p>The AssetOrder lines are generated according to the data of the unfulfilled quantities and amounts. For each InvoiceLine from the Invoice, which product is fixed asset and quantity is not zero, <strong>REMAINING(MQuantity)</strong> and <strong>REMAINING(MLineAmount)</strong> are defined. If at least one of them is not 0, a new AssetOrderLine is created as follows:</p>
<pre><code>AssetOrderLine.Asset = Asset AssetOrderLine.AssetValue = REMAINING(MLineAmount) AssetOrderLine.AssetValueCurrency = InvoiceLine.Invoice.DocumentCurrency AssetOrderLine.Quantity = REMAINING(MQuantity) AssetOrderLine.ParentLineNo = InvoiceLine.LineNo 
AssetOrderLine.ParentDocument = Invoice
</code></pre>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ErpNetDocs/model/blob/master/generations/CRM0207.md/#L1" class="edit-link">Suggest improvement to this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
